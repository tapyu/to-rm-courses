\documentclass[12pt,a4paper]{article}
\input{commands}

% new commands
\usepackage{xparse} % make command behave differently depending on the number of arguments

% items, tables and figs
\usepackage{enumitem}
\usepackage{xltabular}
\usepackage{float} % use the [H] option
\usepackage{tikz}
\usepackage{standalone} % place tikz environments or other material in own source files

% refs
\usepackage{biblatex}

% math
\usepackage{amsmath}
\usepackage{mathtools} % is an extension package to amsmath to use \DeclarePairedDelimiter
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{newtxmath} % for Greek variants (bold, nonitalic, etc...)
\usepackage{stmaryrd} % provides new symbols, such as \llbracket \rrbracket
\usepackage{bm} % for writing tensor, e.g., $\bm{\mathcal{A}}$
\usepackage{IEEEtrantools}
\usepackage{siunitx} % typesetting units and unitless numbers SI (Système International d’Unités) units
\usepackage{physics} % several math macros, such as
% \tr -> trace
% \rank -> rank
% \abs -> |x|
% \norm -> ||x||
% \eval -> evaluated bar x|_y=a
% \order -> Big-O notation
% \Re -> real
% \Im -> imaginary
% \dd[]{} -> differential
% \dv -> derivative
% \pdv -> partial derivative

% newcommands - operators
\let\oldemptyset\emptyset % change empty set
\let\emptyset\varnothing
\DeclareMathOperator*{\argmax}{arg\,max} % argument min
\DeclareMathOperator*{\argmin}{arg\,min} % argument max
\DeclareDocumentCommand\dpdv{}{\displaystyle\partialderivative} % partial derivative in display style
\newcommand{\adj}[1]{\ensuremath{\operatorname{adj}\left(#1\right)}} % adjugate matrix
\newcommand{\cof}[1]{\ensuremath{\operatorname{cof}\left(#1\right)}} % cofactor matrix
\newcommand{\eig}[1]{\ensuremath{\operatorname{eig}\left(#1\right)}} % eigenvalues
\providecommand{\dim}{} % \providecommand defines a macro if it is not yet defined. an empty entry clears it
\renewcommand{\dim}[1]{\ensuremath{\operatorname{dim}\left(#1\right)}} % dimension of a set
\newcommand{\nullspace}[1]{\ensuremath{\operatorname{N}\left(#1\right)}} % nullspace or kernel of the matrix
\newcommand{\nullity}[1]{\ensuremath{\operatorname{nullity}\left(#1\right)}} % nullity=dim(N(A))
\newcommand{\spn}[1]{\ensuremath{\operatorname{span}\left#1\right\}}} % span of a set of vectors, \span is a reserved word
\newcommand{\range}[1]{\ensuremath{\operatorname{C}\left(#1\right)}} % range or columnspace of a matrix=span(a1,a2, ..., an), where ai is the ith column vector of the matrix A
\newcommand{\diag}[1]{\ensuremath{\operatorname{diag}\left(#1\right)}} % diagonal operator
\DeclareDocumentCommand{\vec}{om}{\ensuremath{\operatorname{vec}\IfValueT{#1}{_{\operatorname{#1}}}\left(#2\right)}} % vectorize operator, e.g., \vec[]{\mathbf{A}}
\newcommand{\unvec}[1]{\ensuremath{\operatorname{unvec}\left(#1\right)}} % unvectorize operator
\makeatletter % changes the catcode of @ to 11
% circular convolution a lá Oppenheim (if possible, prefer \circledast)
\newcommand*\circconv[1]{%
  \begin{tikzpicture}
    \node[draw,circle,inner sep=1pt] {#1};
  \end{tikzpicture}}

% 
\DeclarePairedDelimiter\ceil{\lceil}{\rceil} % ⌈x⌉
\let\oldceil\ceil
\def\ceil{\@ifstar{\oldceil}{\oldceil*}} % swap the asterist and the nonasterisk behaviors
% 
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor} % ⌊x⌋
\let\oldfloor\floor
\def\floor{\@ifstar{\oldfloor}{\oldfloor*}}
% 
\DeclarePairedDelimiter\inner{\langle}{\rangle} % inner product〈a|b〉
\let\oldinner\inner
\def\inner{\@ifstar{\oldinner}{\oldinner*}}
% 
\makeatother % changes the catcode of @ back to 12
\newcommand{\frob}[1]{\ensuremath{\norm{#1}_\textrm{F}}} % Frobenius norm
\newcommand{\dom}[1]{\ensuremath{\operatorname{dom}\left(#1\right)}} % domain of the function
\newcommand{\intersection}{\bigcap\limits} % intersection operator
% 
% newcommands - comments or corrections
\newcommand{\obs}[1]{\textcolor{red}{(#1)}} % comment
\newcommand{\sizecorr}[1]{\makebox[0cm]{\phantom{$\displaystyle #1$}}} % Used to seize the height of equation
\newcommand{\ensureoperation}{\negmedspace {}} % To ensure that a new line symbol is an operation instead of a sign

\begin{document}

\author{Rubem Vasconcelos Pacelli}
\title{Convex Optimization homework}
\date{\today}
\maketitle

%%--CABEÇALHO--%%
\begin{center}
{\LARGE Nonlinear Optimization Systems \par}
{\Large Teleinformatics Engineering \par}
{\Large Yuri Carvalho Barbosa Silva, Tarcisio Ferreira Maciel \par}
% {\Large Opitional}
\end{center}

%============================================
\problem \label{probone}
Convexity of some sets. Determine if each set below is convex
\b
\subproblem  \(\left\{ (x,y) \in \mathbb{R}_{++}^{2} \mid x/y \leq 1 \right\}\)
\subanswer
The norm cone is given by
\begin{align}
    C = \left\{ (x_1, x_2, \cdots, x_n, t) \in \mathbb{R}^{n+1} \mid \mathbf{x} \in \mathbb{R}^{n}, \norm{\mathbf{x}}_{p} \leq t \right\} \subseteq \mathbb{R}^{n+1}.
\end{align}
When \(n=1\) and \(p=1\) (Manhattan norm), we have that
\begin{align}
    \label{eq:cone-n1-p1}
    C = \left\{ (x, y) \in \mathbb{R}^{2} \mid \abs{x}/y \leq 1 \right\} \subseteq \mathbb{R}^{2},
\end{align}
where \(t = y\) and \(x_1 = x\). From the Equation \eqref{eq:cone-n1-p1}, it is easy to conclude that \(y>0\).
Let us further define the function \(f: \mathbb{R}^2 \rightarrow \mathbb{R}^2\), given by
\begin{align}
    f(x, y) = \begin{bmatrix}
	\abs{x} & y
\end{bmatrix}^\top.
\end{align}
This function is clearly convex since the absolute operation is convex. Once it is well-known that the norm cone is convex, and \(f\) is a convex function in \(C \subseteq \dom{f}\), then
\begin{align}
    S = f(C) = \left\{ (x, y) \in \mathbb{R}^{2}_{++} \mid x/y \leq 1 \right\}
\end{align}
is also convex, which is the set of the question. The Figure \ref{fig:2.8a} shows this set for \(0\leq x \leq 3\) and \(0\leq y \leq 3\).
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.08]{figs/2.8a.png}
    \caption{Set of the item a.}
    \label{fig:2.8a}
\end{figure}

\subproblem \(\left\{ (x,y) \in \mathbb{R}_{++}^{2} \mid x/y \geq 1 \right\}\)
\subanswer

The set \(S = \left\{ \mathbf{v} \in \mathbb{R}_{++}^{2} \mid v_0/v_1 \geq 1 \right\}\), where \(\mathbf{v} = (v_0, v_1)\), is convex iff the convex combination of a pair of points belonging to \(S\), e.g., \(\mathbf{x} = (x_0, x_1)\) and \(\mathbf{y} = (y_0, y_1)\), also belong to \(S\). Mathematically,
\begin{align}
    \mathbf{w} & = \theta \mathbf{x} + (1-\theta)\mathbf{y} = \mqty[\theta x_0 + (1 - \theta)y_0 \\ \theta x_1 + (1 - \theta)y_1]
\end{align}
should belong to \(S\) to any \(\mathbf{x}, \mathbf{y} \in S\) and \(0\leq\theta\leq 1\). Therefore
\begin{align}
    \frac{\theta x_0 + (1 - \theta)y_0}{\theta x_1 + (1 - \theta)y_1} & \geq 1\\
    \theta x_0 + (1 - \theta)y_0 & \geq \theta x_1 + (1 - \theta)y_1 \\
    \frac{x_0}{x_1}\frac{\theta}{y_1} + \frac{y_0}{y_1} \frac{1 - \theta}{x_1} & \geq \frac{\theta}{y_1} + \frac{1 - \theta}{x_1}
\end{align}

This expression always holds for any value of \(\mathbf{x}, \mathbf{y} \in S\). Then, \(\mathbf{w} \in S\). The Figure \ref{fig:2.8b} shows this set for \([0, 3]\).
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.3]{figs/2.8b.png}
    \caption{Set of the item b.}
    \label{fig:2.8b}
\end{figure}

\subproblem \(\left\{ (x,y) \in \mathbb{R}_{+}^{2} \mid xy \leq 1 \right\}\)

\subanswer

If \(S = \left\{ \mathbf{v} \in \mathbb{R}_{+}^{2} \mid v_0v_1 \leq 1 \right\}\), where \(\mathbf{v} = (v_0, v_1)\), then \(S\) is convex iff
\begin{align}
    \mathbf{w} = \theta \mathbf{x} + (1-\theta)\mathbf{y} \in S \;\forall\; \mathbf{x}, \mathbf{y} \in S, 0\leq\theta\leq 1,
    \label{eq:convex-rule}
\end{align}
which is the convex combination of \(\mathbf{x}\) and \(\mathbf{y}\). Let us prove that this set is nonconvex by contradiction. Once \(\mathbf{x}, \mathbf{y} \in S\), we have that
\begin{align}
    x_0x_1 \leq 1
\end{align}
and
\begin{align}
    y_0y_1 \leq 1,
\end{align}
where \(\mathbf{x} = (x_0, x_1), \mathbf{y} = (y_0, y_1)\). The second component of \(\mathbf{w} = (w_0, w_1)\) is given by
\begin{align}
    \label{eq:2c1}
    w_1 & = \theta x_1 + (1-\theta)y_1 \\
    % w_0y_0 & = \theta x_1 y_0 + (1-\theta)y_1 y_0 \\
    % y_0 y_1 & = \frac{w_0y_0 - \theta x_1 y_0}{1-\theta} \leq 1.
\end{align}
If \(x_1 \gg 0\) and \(y_0 \gg 0\), which leads to \(x_0 \rightarrow 0\) and \(y_1 \rightarrow 0\), respectively, and \(\theta = 0.5\), then, from \eqref{eq:2c1}, we have that
\begin{align}
    w_1 & \approx 0.5 x_1.
\end{align}
Since \(x_1\) can be indiscriminality large, we have that \(w_1 \gg 0\), which leads to \(w_0 \rightarrow 0\) if \(\mathbf{w} \in S\). On the other hand, the first component of \(w_0\) is given by
\begin{align}
    \label{eq:2c2}
    w_0 & = \theta x_0 + (1-\theta)y_0 \\
    w_0 & = 0.5y_0
\end{align}
Since \(y_0\) can be indiscriminately large, we have that \(w_0 \gg 0\). However, the statement \(w_0 \rightarrow 0\) should be true in order to \(\mathbf{w}\) belong to \(S\). The contradiction leads us to conclude that \(\mathbf{w} \not\in S\). The Figure \ref{fig:2.8c} shows the set S, and the Figure \ref{fig:2.8c-set} shows the cone set \(K\) in which \(\mathbf{x} \preceq_K \mathbf{w} \preceq_K \mathbf{y}\).
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.4]{figs/2.8c.png}
    \caption{Set of the item c.}
    \label{fig:2.8c}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.2]{figs/2.8_set.png}
    \caption{Cone set in which \(\mathbf{x} \preceq_K \mathbf{w} \preceq_K \mathbf{y}\).}
    \label{fig:2.8c-set}
\end{figure}


Since \(x_1 \gg 0\), \(w_0 \rightarrow 0\)

% Note that this set is equivalent to
% \begin{align}
%     \left\{ x \in \mathbb{R} \mid x\geq 0 \right\} \times \left\{ y \in \mathbb{R} \mid 0 \leq y \leq 1/x  \right\}.
% \end{align}

% Note that the first set is clearly linear since it is a close halfplane in \(\mathbb{R}\). If \(A = \left\{ x \in \mathbb{R} \mid x\geq 0 \right\}\), the second set is the image of \(A\) under \(f\), where
% \begin{align}
%     f(x) = \frac{1}{x}.
% \end{align}
% Mathematically,
% \begin{align}
%     B = f(A) = \left\{ y \in \mathbb{R} \mid 0 \leq y \leq 1/x  \right\}.
% \end{align}

% Once \(A\) is a convex set and \(f\) is a convex function, we conclude that \(B\) is convex. Thus, \(A \times B\) is also convex. The Figure X
% \begin{figure}[H]
%     \centering
%     \label{fig:2.8b}
%     \includegraphics[scale=0.4]{figs/2.8c.png}
% \end{figure}


\subproblem  \(\left\{ (x,y) \in \mathbb{R}_{+}^{2} \mid xy \geq 1 \right\}\)

By using the convex combination, the vector \(\mathbf{w} = (w_0, w_1)\), which is given by
\begin{align}
    \mathbf{w} = \theta \mathbf{x} + (1-\theta)\mathbf{y} = \mqty[\theta x_0 + (1 - \theta)y_0 \\ \theta x_1 + (1 - \theta)y_1],
\end{align}
shall belong to \(S\), for any \(\mathbf{x}, \mathbf{y} \in S\). If it is true, then
\begin{align}
    (\theta x_0 + (1 - \theta)y_0)(\theta x_1 + (1 - \theta)y_1) & \geq 1\\
    \theta^2 x_0 x_1 + \theta(1 - \theta)y_1 x_0 + (1 - \theta)\theta x_1 y_0 + (1 - \theta)^2 y_0 y_1 & \geq 1\\
    \theta^2 x_0 x_1 + \theta(1 - \theta)(y_1 x_0 + x_1 y_0) + (1 - \theta)^2 y_0 y_1 & \geq 1 \\
    (x_0 x_1 - y_1 x_0 - x_1 y_0 + y_0 y_1 )\theta^2 + (y_1 x_0 + x_1 y_0 - 2y_0 y_1) \theta + y_0 y_1 - 1 & \geq 0 \\
    f(\theta)& \geq 0
\end{align}

Note that \(f\) is a second-order function. The previous inequation holds if \(f\) has either no roots or only one root, that is
\begin{align}
    (y_1 x_0 + x_1 y_0 - 2y_0 y_1)^2 - 4(x_0 x_1 - y_1 x_0 - x_1 y_0 + y_0 y_1 )(y_0 y_1 - 1) \geq 0 \\
    (y_1 x_0 + x_1 y_0 - 2y_0 y_1)^2 \geq 4(x_0 x_1 - y_1 x_0 - x_1 y_0 + y_0 y_1 )(y_0 y_1 - 1)
    % (y_1 x_0 + x_1 y_0 - 2y_0 y_1)^2 - 4 y_0 y_1x_0 x_1 + 4y_0 y_1^2 x_0 \nonumber \\
    % + 4y_1x_1y_0^2 - 4y_0^2 y_1^2 + 4x_0 x_1 - 4y_1 x_0 - 4x_1 y_0 + 4y_0 y_1 \geq 0 \\
    % (y_1 x_0 + x_1 y_0 - 2y_0 y_1)^2 + 4y_0 y_1^2 x_0 + 4y_1x_1y_0^2 + 4x_0 x_1 + + 4y_0 y_1 \nonumber \\
    % - 4 y_0 y_1x_0 x_1 - 4y_0^2 y_1^2 - 4y_1 x_0 - 4x_1 y_0 \geq 0 \nonumber
\end{align}
Let us analyze carefully this inequation
\begin{enumerate}
    \item If the RHS is greater than the LHS, this inequation is not satisfied. Hence, we must assess it for the worst case, where the LHS is as high as possible, and see whether this inequation holds.
    \item The worst case is when \(x_0 \gg 0\) and \(x_1 \gg 0\), and \(y_0=y_1=1\) because the term \(x_0 x_1\) cannot be quadratically compensated with \((x_0 x_1)^2\) on the LHS. Otherwise, the higher the values of \(y_0\) and \(y_1\), the lower the RHS becomes\footnote{The quadratic term \(4y_0^2 y_1^2\) on the RHS that could increase it is canceled with the very same term \(4y_0^2 y_1^2\) on the LHS.}.
    \item However, even for this case, the LHS becomes approximately equal to \((x_0 + x_1)^2 = x_0^2 + 2x_0x_1 + x_1^2\), which is greater than \(x_0x_1\)
\end{enumerate}

Therefore, the function \(f\) has no roots and the set \(\left\{ (x,y) \in \mathbb{R}_{+}^{2} \mid xy \geq 1 \right\}\) is convex. The Figure \ref{fig:28d} shows this set.
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.4]{figs/2.8d.png}
    \label{fig:28d}
\end{figure}

%============================================

\problem

Let \(S = \left\{\boldsymbol{\alphaup} \in \mathbb{R}^3 | \alpha_1 + \alpha_2e^{-t} + \alpha_3e^{-2t} \leq 1.1\text{ for }t \geq 1\right\}\). Is S affine, a halfspace, a convex cone, a convex set, or none of these?

The set \(S\) is affine iff its affine combination is also affine, that is,
\begin{align}
    \mathbf{w} = \theta_1 \mathbf{x} + \theta_2 \mathbf{y} = \mqty[\theta_1 x_1 + \theta_2 y_1 \\ \theta_1 x_2 + \theta_2 y_2\\ \theta_1 x_3 + \theta_2 y_3] \in S \;\forall\; \mathbf{x}, \mathbf{y} \in S, \mathbf{1}^\top\boldsymbol{\thetaup}=1,
\end{align}
where \(\boldsymbol{\thetaup} = (\theta_1, \theta_2)\), \(\mathbf{x} = (x_1, x_2, x_3)\), and \(\mathbf{y} = (y_1, y_2, y_3)\). If \(\mathbf{w} \in S\), then
\begin{align}
    \label{eq:2.15-1}
    \theta_1 x_1 + \theta_2 y_1 + (\theta_1 x_2 + \theta_2 y_2)e^{-t} + (\theta_1 x_3 + \theta_2 y_3)e^{-2t} & \leq 1.1 \nonumber \\
    \theta_1 \left( x_1 + x_2e^{-t} + x_3e^{-2t} \right) + \theta_2 \left( y_1 + y_2e^{-t} + y_3e^{-2t} \right) & \leq 1.1
\end{align}
Once \(\mathbf{x}, \mathbf{y} \in S\), \(x_1 + x_2e^{-t} + x_3e^{-2t} \leq 1.1\) and \(y_1 + y_2e^{-t} + y_3e^{-2t} \leq 1.1\), the worst case when this inequation might not be satisfied is then \(x_1 + x_2e^{-t} + x_3e^{-2t} = y_1 + y_2e^{-t} + y_3e^{-2t} = 1.1\). In this case, we have
\begin{align}
    1.1(\theta_1 + \theta_2) \leq 1.1\\
    1.1 \leq 1.1.
\end{align}

As the inequation holds, \(S\) is affine, which is consequently convex. The set \(S\) is a cone set iff the result of the conic combination also belongs to \(S\), that is,
\begin{align}
    \mathbf{w} = \theta_1 \mathbf{x} + \theta_2 \mathbf{y} = \mqty[\theta_1 x_1 + \theta_2 y_1 \\ \theta_1 x_2 + \theta_2 y_2\\ \theta_1 x_3 + \theta_2 y_3] \in S \;\forall\; \mathbf{x}, \mathbf{y} \in S, \boldsymbol{\thetaup}\succeq \mathbf{0}.
\end{align}
Recalling the Equation \eqref{eq:2.15-1}, we can clearly see that this inequation does not hold for \(\theta_1 \gg 0\), \(\theta_2 \gg 0\), and \(x_1 + x_2e^{-t} + x_3e^{-2t} = y_1 + y_2e^{-t} + y_3e^{-2t} = 1.1\). Thus, the set \(S\) is not a cone set. This set might be a close halfspace though, once halfspaces is a set of the form
\begin{align}
    \left\{ \mathbf{x} \mid \mathbf{a}^\top \mathbf{x} \leq b \right\}.
\end{align}

Considering that \(t \geq 1\) is a constant, we can rewrite \(S\) as
\begin{align}
    S = \left\{ \boldsymbol{\alphaup} \in \mathbb{R}^3 \mid \mathbf{a}^\top \boldsymbol{\alphaup} \leq b \right\},
\end{align}

where \(\mathbf{a} = (1, e^{-t}, e^{-2t})\) and \(b=1.1\). Therefore, \(S\) is a halspace.



\end{document}